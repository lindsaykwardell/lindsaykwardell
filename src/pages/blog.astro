---
import BaseLayout from '../layouts/BaseLayout.astro'
import BlogPostPreview from '../components/BlogPostPreview.vue'
import { getPodcasts } from '../api/podcasts.mjs'
import naturalOrder from 'natural-order'
import Search from '../components/Search.vue'

const podcasts = await getPodcasts()
const posts = await Astro.glob('../pages/blog/*.md').then((posts) =>
  posts.map((post) => ({
    ...post.frontmatter,
    title: post.frontmatter.title,
    url: post.url,
    type: 'blog',
    host: !post.frontmatter.link?.includes('https://'),
    name: post.frontmatter.name || 'Lindsay Wardell Blog',
    pubDate: post.frontmatter.pubDate,
  }))
)

const allPosts = naturalOrder([...podcasts, ...posts])
  .orderBy('desc')
  .sort(['pubDate'])
---

<BaseLayout>
  <div>
    <h2 class="text-5xl text-center py-4">Content</h2>
    <Search client:idle content={allPosts} />
    <!-- <div class="flex flex-col lg:flex-row flex-wrap">
      {allPosts.map(p => (
        <div class="w-full lg:w-1/2 xl:w-1/3 p-4">
          <BlogPostPreview item={p} />
        </div>
      ))}
    </div> -->
  </div>
</BaseLayout>
